services:
    _defaults:
        autowire: true
        autoconfigure: true
        public: false

    TwoFactorBundle\Provider\Message\TemplateProvider\TemplateProvider: ~

    TwoFactorBundle\Provider\:
        resource: '../../Provider/*'
        exclude: '../../Provider/Message/Exceptions'

    TwoFactorBundle\Provider\Message\Email\EmailMessenger:
        arguments:
            $templates: '%2fa.email_templates%'
    TwoFactorBundle\Provider\Message\Email\EmailProvider:
        tags:
            - { name: '2fa.provider', alias: 'email' }

    TwoFactorBundle\Provider\Message\Sms\SmsMessenger:
        arguments:
            $templates: '%2fa.sms_templates%'
    TwoFactorBundle\Provider\Message\Sms\SmsProvider:
        tags:
            - { name: '2fa.provider', alias: 'sms' }

    TwoFactorBundle\Validator\Constraints\:
        resource: '../../Validator/Constraints/*Validator.php'
        tags:
            - { name: validator.constraint_validator }
            
    TwoFactorBundle\EventListener\LoginSuccessListener:
        tags:
            - { name: kernel.event_listener, event: security.interactive_login, method: onSecurityInteractiveLogin }
        arguments:
            $environment: "%kernel.environment%"

    TwoFactorBundle\EventListener\KernelRequestListener:
        tags:
            - { name: kernel.event_listener, event: kernel.request }
