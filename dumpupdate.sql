ALTER TABLE transaction CHANGE transaction_status transaction_status TINYINT NOT NULL COMMENT '(DC2Type:tinyint)', CHANGE transaction_is_voided transaction_is_voided TINYINT(1) DEFAULT '0' NOT NULL;
ALTER TABLE transaction ADD CONSTRAINT FK_723705D12F1CD6DE FOREIGN KEY (transaction_customer_id) REFERENCES customer (customer_id);
ALTER TABLE transaction ADD CONSTRAINT FK_723705D1B8E9B9B1 FOREIGN KEY (transaction_gateway_id) REFERENCES gateway (gateway_id);
ALTER TABLE transaction ADD CONSTRAINT FK_723705D199633FFF FOREIGN KEY (transaction_currency_name) REFERENCES currency (currency_name);
CREATE INDEX IDX_723705D12F1CD6DE ON transaction (transaction_customer_id);
CREATE INDEX IDX_723705D1B8E9B9B1 ON transaction (transaction_gateway_id);
CREATE INDEX IDX_723705D199633FFF ON transaction (transaction_currency_name);
ALTER TABLE transaction RENAME INDEX tbl_trn_uq_number TO UNIQ_723705D1E0ED6D14;
ALTER TABLE country ADD CONSTRAINT FK_5373C9662DB3ABBD FOREIGN KEY (country_currency_id) REFERENCES currency (currency_id);
CREATE INDEX IDX_5373C9662DB3ABBD ON country (country_currency_id);
ALTER TABLE country RENAME INDEX tbl_cty_uq_code TO UNIQ_5373C966F026BB7C;
ALTER TABLE country RENAME INDEX tbl_cty_uq_name TO UNIQ_5373C966D910F5E2;
ALTER TABLE customer_product CHANGE cproduct_product_id cproduct_product_id INT UNSIGNED NOT NULL, CHANGE cproduct_is_active cproduct_is_active TINYINT(1) DEFAULT '1' NOT NULL;
ALTER TABLE customer_product ADD CONSTRAINT FK_CF97A013A32A23C6 FOREIGN KEY (cproduct_product_id) REFERENCES product (product_id);
ALTER TABLE customer_product ADD CONSTRAINT FK_CF97A0136ACAB2D9 FOREIGN KEY (cproduct_customer_id) REFERENCES customer (customer_id);
CREATE INDEX IDX_CF97A013A32A23C6 ON customer_product (cproduct_product_id);
CREATE INDEX IDX_CF97A0136ACAB2D9 ON customer_product (cproduct_customer_id);
ALTER TABLE customer_product RENAME INDEX tbl_cpd_uq_username TO UNIQ_CF97A01336C5DA82;
ALTER TABLE customer ADD customer_currency_id INT UNSIGNED NOT NULL, ADD customer_country_id INT UNSIGNED NOT NULL, CHANGE customer_socials customer_socials JSON NOT NULL COMMENT '(DC2Type:json)', CHANGE customer_level customer_level INT DEFAULT 1 NOT NULL, CHANGE customer_files customer_files JSON NOT NULL COMMENT '(DC2Type:json)', CHANGE customer_joined_at customer_joined_at DATETIME NOT NULL, CHANGE customer_is_affiliate customer_is_affiliate TINYINT(1) DEFAULT '0' NOT NULL;
ALTER TABLE customer ADD CONSTRAINT FK_81398E0991CA0783 FOREIGN KEY (customer_affiliate_id) REFERENCES customer (customer_id);
ALTER TABLE customer ADD CONSTRAINT FK_81398E09BBB3772B FOREIGN KEY (customer_user_id) REFERENCES user (user_id);
ALTER TABLE customer ADD CONSTRAINT FK_81398E093B6FAA7E FOREIGN KEY (customer_currency_id) REFERENCES currency (currency_id);
ALTER TABLE customer ADD CONSTRAINT FK_81398E094E63AF2 FOREIGN KEY (customer_country_id) REFERENCES country (country_id);
CREATE UNIQUE INDEX UNIQ_81398E0991CA0783 ON customer (customer_affiliate_id);
CREATE INDEX IDX_81398E093B6FAA7E ON customer (customer_currency_id);
CREATE INDEX IDX_81398E094E63AF2 ON customer (customer_country_id);
ALTER TABLE customer RENAME INDEX tbl_customer_uq_user_id TO UNIQ_81398E09BBB3772B;
ALTER TABLE bonus CHANGE bonus_is_active bonus_is_active TINYINT(1) DEFAULT '1' NOT NULL, CHANGE bonus_terms bonus_terms LONGTEXT NOT NULL;
ALTER TABLE user DROP user_key, DROP user_activation_code, DROP user_activation_sent_timestamp, DROP user_activation_timestamp, CHANGE user_username user_username VARCHAR(25) NOT NULL, CHANGE user_email user_email VARCHAR(255) NOT NULL, CHANGE user_type user_type INT NOT NULL, CHANGE user_is_active user_is_active TINYINT(1) DEFAULT '1' NOT NULL, CHANGE user_created_by user_created_by INT DEFAULT NULL, CHANGE user_updated_by user_updated_by INT NOT NULL, CHANGE user_updated_at user_updated_at DATETIME NOT NULL, CHANGE user_group_id user_group_id INT DEFAULT NULL, CHANGE user_zendesk_id user_zendesk_id INT DEFAULT NULL;
ALTER TABLE user ADD CONSTRAINT FK_8D93D6491ED93D47 FOREIGN KEY (user_group_id) REFERENCES `group` (group_id);
CREATE INDEX IDX_8D93D6491ED93D47 ON user (user_group_id);
ALTER TABLE user RENAME INDEX tbl_user_uq_username TO UNIQ_8D93D64918D3E277;
ALTER TABLE user RENAME INDEX tbl_user_uq_email TO UNIQ_8D93D649550872C;
ALTER TABLE session CHANGE id id INT AUTO_INCREMENT NOT NULL, CHANGE session_user_id session_user_id INT NOT NULL;
ALTER TABLE session ADD CONSTRAINT FK_D044D5D4BF396750 FOREIGN KEY (id) REFERENCES user (user_id);
CREATE UNIQUE INDEX UNIQ_D044D5D4BF396750 ON session (id);
ALTER TABLE setting CHANGE setting_id setting_id INT AUTO_INCREMENT NOT NULL;
ALTER TABLE setting RENAME INDEX tbl_set_uk_code TO UNIQ_9F74B898B6A11C7E;
ALTER TABLE product CHANGE product_id product_id INT UNSIGNED AUTO_INCREMENT NOT NULL, CHANGE product_is_active product_is_active TINYINT(1) NOT NULL, CHANGE product_created_by product_created_by INT DEFAULT NULL, CHANGE product_updated_by product_updated_by INT NOT NULL, CHANGE product_updated_at product_updated_at DATETIME NOT NULL, CHANGE product_logo_uri product_logo_uri VARCHAR(255) NOT NULL, CHANGE product_url product_url VARCHAR(255) NOT NULL;
ALTER TABLE product RENAME INDEX tbl_pd_uq_code TO UNIQ_D34A04ADFAFD1239;
ALTER TABLE product RENAME INDEX tbl_pd_uq_name TO UNIQ_D34A04ADD3CB5CA7;
ALTER TABLE `group` CHANGE group_id group_id INT AUTO_INCREMENT NOT NULL, CHANGE group_created_by group_created_by INT DEFAULT NULL, CHANGE group_updated_by group_updated_by INT NOT NULL, CHANGE group_updated_at group_updated_at DATETIME NOT NULL;
CREATE UNIQUE INDEX UNIQ_6DC044C577792576 ON `group` (group_name);
ALTER TABLE currency CHANGE currency_code currency_code VARCHAR(6) NOT NULL, CHANGE currency_created_by currency_created_by INT DEFAULT NULL, CHANGE currency_updated_by currency_updated_by INT NOT NULL, CHANGE currency_updated_at currency_updated_at DATETIME NOT NULL, CHANGE currency_rate currency_rate NUMERIC(10, 10) DEFAULT '1' NOT NULL;
ALTER TABLE currency RENAME INDEX tbl_cur_uq_code TO UNIQ_6956883FFDA273EC;
ALTER TABLE currency RENAME INDEX tbl_cur_uq_name TO UNIQ_6956883FD4943D72;
ALTER TABLE announcement CHANGE announcement_id announcement_id INT AUTO_INCREMENT NOT NULL, CHANGE announcement_is_active announcement_is_active TINYINT NOT NULL COMMENT '(DC2Type:tinyint)', CHANGE announcement_created_by announcement_created_by INT DEFAULT NULL, CHANGE announcement_updated_by announcement_updated_by INT NOT NULL, CHANGE announcement_updated_at announcement_updated_at DATETIME NOT NULL, CHANGE announcement_image_uri announcement_image_uri VARCHAR(255) DEFAULT NULL;
ALTER TABLE dwl CHANGE dwl_id dwl_id BIGINT AUTO_INCREMENT NOT NULL, CHANGE dwl_product_id dwl_product_id INT UNSIGNED DEFAULT NULL, CHANGE dwl_currency_id dwl_currency_id INT UNSIGNED DEFAULT NULL, CHANGE dwl_status dwl_status SMALLINT DEFAULT 1 NOT NULL, CHANGE dwl_version dwl_version SMALLINT DEFAULT 1 NOT NULL, CHANGE dwl_created_by dwl_created_by INT DEFAULT NULL, CHANGE dwl_updated_by dwl_updated_by INT NOT NULL, CHANGE dwl_updated_at dwl_updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL;
ALTER TABLE dwl ADD CONSTRAINT FK_94E578ACE35D056E FOREIGN KEY (dwl_product_id) REFERENCES product (product_id);
ALTER TABLE dwl ADD CONSTRAINT FK_94E578AC1936ACA0 FOREIGN KEY (dwl_currency_id) REFERENCES currency (currency_id);
CREATE INDEX IDX_94E578ACE35D056E ON dwl (dwl_product_id);
CREATE INDEX IDX_94E578AC1936ACA0 ON dwl (dwl_currency_id);
DROP INDEX tbl_gtw_uq_name_curr ON gateway;
ALTER TABLE gateway CHANGE gateway_id gateway_id INT AUTO_INCREMENT NOT NULL, CHANGE gateway_currency_id gateway_currency_id INT UNSIGNED DEFAULT NULL, CHANGE gateway_balance gateway_balance NUMERIC(65, 10) NOT NULL, CHANGE gateway_payment_option gateway_payment_option VARCHAR(255) NOT NULL, CHANGE gateway_is_active gateway_is_active TINYINT(1) NOT NULL, CHANGE gateway_created_by gateway_created_by INT DEFAULT NULL, CHANGE gateway_updated_by gateway_updated_by INT NOT NULL, CHANGE gateway_updated_at gateway_updated_at DATETIME NOT NULL;
ALTER TABLE gateway ADD CONSTRAINT FK_14FEDD7FB2527E6 FOREIGN KEY (gateway_currency_id) REFERENCES currency (currency_id);
CREATE UNIQUE INDEX UNIQ_14FEDD7F3D4E91C8 ON gateway (gateway_name);
CREATE INDEX IDX_14FEDD7FB2527E6 ON gateway (gateway_currency_id);
ALTER TABLE sub_transaction CHANGE subtransaction_id subtransaction_id INT AUTO_INCREMENT NOT NULL, CHANGE subtransaction_transaction_id subtransaction_transaction_id BIGINT UNSIGNED DEFAULT NULL, CHANGE subtransaction_customer_product_id subtransaction_customer_product_id BIGINT UNSIGNED DEFAULT NULL;
ALTER TABLE sub_transaction ADD CONSTRAINT FK_97CE704F1F028B15 FOREIGN KEY (subtransaction_transaction_id) REFERENCES transaction (transaction_id);
ALTER TABLE sub_transaction ADD CONSTRAINT FK_97CE704F4464C11B FOREIGN KEY (subtransaction_customer_product_id) REFERENCES customer_product (cproduct_id);
CREATE INDEX IDX_97CE704F1F028B15 ON sub_transaction (subtransaction_transaction_id);
CREATE INDEX IDX_97CE704F4464C11B ON sub_transaction (subtransaction_customer_product_id);
