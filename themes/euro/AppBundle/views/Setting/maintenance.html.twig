{% extends 'AppBundle:Layout:base.html.twig' %}

{% block title %}{{ 'page.title.setting.maintenance'|trans({},'AppBundle') }}{% endblock %}

{% block stylesheet_plugins %}
    {{ form_assetcss(form) }}
{% endblock %}

{% block javascript_plugins %}
    {{ form_assetjs(form) }}
{% endblock %}

{% block pageTitle -%}{{ "settings.maintenance.label"|trans({},"AppBundle") }}{%- endblock pageTitle %}

{% block breadcrumb -%}
    <li>{{ "breadcrumb.setting"|trans({},"AppBundle") }}</li>
    <li class="active">{{ "settings.maintenance.label"|trans({},"AppBundle") }}</li>
{%- endblock %}

{% block page %}
    <div class="col-sm-12">
        <ul class="nav nav-tabs">
            <li class="li-tab active">
                <a href="#app" data-toggle="tab">
                    <span class="hidden-xs">App Maintenance</span>
                </a>
            </li>
            <li class="li-tab">
                <a href="#integration" data-toggle="tab">
                    <span class="hidden-xs">Integration Maintenance</span>
                </a>
            </li>
        </ul>
        <div class="tab-content bg-muted">
            <div class="tab-pane active" id="app">
                <div class="card-box">
                    <h4 class="m-b-20"><b>App Maintenance</b></h4>
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="list-group m-b-0">
                                <a href="#" class="list-group-item"> 
                                    <div class="row">
                                        <label class="col-sm-3 control-label">Member Site</label>
                                        <div class="col-sm-6">
                                            <input name="app" attr-key="memberSite" class="switch" type="checkbox" data-plugin="switchery" data-color="#1AB394" data-secondary-color="#ED5565" />
                                        </div>
                                    </div>
                                </a> 
                                <a href="#" class="list-group-item"> 
                                    <div class="row">
                                        <label class="col-sm-3 control-label">Affiliate Site</label>
                                        <div class="col-sm-6">
                                            <input name="app" attr-key="affiliateSite" class="switch" type="checkbox" data-plugin="switchery" data-color="#1AB394" data-secondary-color="#ED5565" />
                                        </div>
                                    </div>
                                </a> 
                            </div>
                        </div>
                        <div class="col-sm-6"></div>
                    </div>
                </div>
            </div>
            <div class="tab-pane" id="integration">
                <div class="card-box">
                    <h4 class="m-b-20"><b>Integration Maintenance</b></h4>
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="list-group m-b-0">
                                <a href="#" class="list-group-item"> 
                                    <div class="row">
                                        <label class="col-sm-3 control-label">PIWIXchange</label>
                                        <div class="col-sm-6">
                                            <input name="integration" attr-key="piwixchange" class="switch" type="checkbox" data-plugin="switchery" data-color="#1AB394" data-secondary-color="#ED5565" />
                                        </div>
                                    </div>
                                </a> 
                                <a href="#" class="list-group-item"> 
                                    <div class="row">
                                        <label class="col-sm-3 control-label">Sports</label>
                                        <div class="col-sm-6">
                                            <input name="integration" attr-key="sports" class="switch" type="checkbox" data-plugin="switchery" data-color="#1AB394" data-secondary-color="#ED5565" />
                                        </div>
                                    </div>
                                </a> 
                                <a href="#" class="list-group-item">
                                    <div class="row">
                                        <label class="col-sm-3 control-label">Casino</label>
                                        <div class="col-sm-6">
                                            <input name="integration" attr-key="casino" class="switch" type="checkbox" data-plugin="switchery" data-color="#1AB394" data-secondary-color="#ED5565" />
                                        </div>
                                    </div>
                                </a> 
                            </div>
                        </div>
                        <div class="col-sm-6"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block javascripts %}
<script type="text/javascript">
    $(document).ready(function() {
        $('.switch').on('change', function() {
            
            var integration = [];
            var app = [];

            $('input[name="integration"]').each(function() {
                var currentStatus = this.checked ? true : false;
                var activeMaintenance = $(this).attr('attr-key');
                integration.push({activeMaintenance: currentStatus});
            });

            $('input[name="app"]').each(function() {
                var currentStatus = this.checked ? true : false;
                var activeMaintenance = $(this).attr('attr-key');
                integration.push({activeMaintenance: currentStatus});
            });

            console.log(integration);
            console.log(app);

            $.ajax({
                type: 'POST',
                url: "{{ path('app.setting.maintenance_save') }}",
                data: {'type': activeMaintenance[0],  'value': {'integration': integration, 'app': app}},
                dataType: 'json',
            }).then(function (response) {
                console.log(response);
            }).fail( function( jqXHR, textStatus, errorThrown ) {
                console.log(errorThrown);
            });
        }); 
    });
</script>
{% endblock %}